setwd("~/Documents/DDCI/Education/JohnsHopkins/ReproducibleResearch/Assignment2")
NOAAData <- read.csv("repdata-data-StormData.csv", header = TRUE, sep = ",")
FatalitiesByEvtype <- data.frame(tapply(NOAAData$FATALITIES, NOAAData$EVTYPE, sum))
FatalitiesByEvtype[ , 2] <- rownames(FatalitiesByEvtype)
Fcols <- c("Fatalities", "EVTYPE")
colnames(FatalitiesByEvtype) <- Fcols
InjuriesByEvtype <- data.frame(tapply(NOAAData$INJURIES, NOAAData$EVTYPE, sum))
InjuriesByEvtype[ , 2] <- rownames(InjuriesByEvtype)
Icols <- c("Injuries", "EVTYPE")
colnames(InjuriesByEvtype) <- Icols
dfHarm <- FatalitiesByEvtype
dfHarm[FatalitiesByEvtype$EVTYPE == InjuriesByEvtype$EVTYPE , 3] <- InjuriesByEvtype$Injuries
colnames(dfHarm) <- c("Fatalities", "EVTYPE", "Injuries")
# add combined column
dfHarm[ , 4] <- dfHarm$Fatalities + dfHarm$Injuries
Hcols <- c("Fatalities", "EVTYPE", "Injuries", "TotalHarm")
colnames(dfHarm) <- Hcols
# Print results out to a table
library(knitr)
dfPrint <- subset(dfHarm[order(-dfHarm$TotalHarm), ])
dfPrint <- subset(dfPrint[1:15, c(1, 3, 4)])
kable(dfPrint, digits = 0, col.names = colnames(dfPrint), format.args = list(big.mark = ","))
PropertyDamageByEvtype <- data.frame(tapply(NOAAData$PROPDMG, NOAAData$EVTYPE, sum))
PropertyDamageByEvtype[ , 2] <- rownames(PropertyDamageByEvtype)
Pcols <- c("PropertyDamage", "EVTYPE")
colnames(PropertyDamageByEvtype) <- Pcols
CropDamageByEvtype <- data.frame(tapply(NOAAData$CROPDMG, NOAAData$EVTYPE, sum))
CropDamageByEvtype[ , 2] <- rownames(CropDamageByEvtype)
Ccols <- c("CropDamage", "EVTYPE")
colnames(CropDamageByEvtype) <- Ccols
dfDamage <- PropertyDamageByEvtype
dfDamage[PropertyDamageByEvtype$EVTYPE == CropDamageByEvtype$EVTYPE , 3] <- CropDamageByEvtype$CropDamage
colnames(dfDamage) <- c("PropertyDamage", "EVTYPE", "CropDamage")
# add combined column
dfDamage[ , 4] <- dfDamage$PropertyDamage + dfDamage$CropDamage
Dcols <- c("PropertyDamage", "EVTYPE", "CropDamage", "TotalDamage")
colnames(dfDamage) <- Dcols
# Print results out to a table
dfPrint2 <- subset(dfDamage[order(-dfDamage$TotalDamage), ])
dfPrint2 <- subset(dfPrint2[1:15, c(1, 3, 4)])
kable(dfPrint2, digits = 0, col.names = colnames(dfPrint2), format.args = list(big.mark = ","))
NOAAData2 <- NOAAData
NOAAData2$BGN_DATE <- as.character(NOAAData2$BGN_DATE)
NOAAData2$BGN_DATE <- as.Date(NOAAData2$BGN_DATE, format = "%m/%d/%Y %H:%M:%S")
NOAAData2$BGN_DATE <- format(NOAAData2$BGN_DATE, format = "%Y")
# sum by EVTYPE year over year
FatalitiesbyYear <- aggregate(NOAAData2$FATALITIES, by = list(Year = NOAAData2$BGN_DATE, EventType = NOAAData2$EVTYPE), sum)
InjuriesbyYear <- aggregate(NOAAData2$INJURIES, by = list(Year = NOAAData2$BGN_DATE, EventType = NOAAData2$EVTYPE), sum)
# add column names
FCol <- c("Year", "EventType", "Fatalities")
colnames(FatalitiesbyYear) <- FCol
ICol <- c("Year", "EventType", "Injuries")
colnames(InjuriesbyYear) <- ICol
# put together data in one df
dfHarmByYear <- FatalitiesbyYear
dfHarmByYear[c(dfHarmByYear$EventType == InjuriesbyYear$EventType | dfHarmByYear$Year == InjuriesbyYear$Year), 4] <- InjuriesbyYear$Injuries
HCol <- c("Year", "EventType", "Fatalities", "Injuries")
colnames(dfHarmByYear) <- HCol
# add total column
dfHarmByYear$TotalHarm <- dfHarmByYear$Fatalities + dfHarmByYear$Injuries
head(dfHarmByYear)
PropertyDamageByYear <- aggregate(NOAAData2$PROPDMG, by = list(Year = NOAAData2$BGN_DATE, EventType = NOAAData2$EVTYPE), sum)
CropDamageByYear <- aggregate(NOAAData2$CROPDMG, by = list(Year = NOAAData2$BGN_DATE, EventType = NOAAData2$EVTYPE), sum)
head(PropertyDamageByYear)
head(CropDamageByYear)
PCol <- c("Year", "EventType", "PropertyDamage")
colnames(PropertyDamagebyYear) <- PCol
CCol <- c("Year", "EventType", "CropDamage")
PCol <- c("Year", "EventType", "PropertyDamage")
colnames(PropertyDamageByYear) <- PCol
CCol <- c("Year", "EventType", "CropDamage")
colnames(CropDamagebyYear) <- CCol
PCol <- c("Year", "EventType", "PropertyDamage")
colnames(PropertyDamageByYear) <- PCol
CCol <- c("Year", "EventType", "CropDamage")
colnames(CropDamageByYear) <- CCol
head(PropertyDamageByYear)
head(CropDamageByYear)
dfDamageByYear <- PropertyDamageByYear
dfDamageByYear[c(dfDamageByYear$EventType == CropDamagebyYear$EventType | dfDamageByYear$Year == CropDamagebyYear$Year), 4] <- CropDamagebyYear$CropDamage
DCol <- c("Year", "EventType", "PropertyDamage", "CropDamage")
colnames(dfDamageByYear) <- DCol
dfDamageByYear <- PropertyDamageByYear
head(dfDamageByYear)
dfDamageByYear[c(dfDamageByYear$EventType == CropDamageByYear$EventType | dfDamageByYear$Year == CropDamageByYear$Year), 4] <- CropDamageByYear$CropDamage
DCol <- c("Year", "EventType", "PropertyDamage", "CropDamage")
colnames(dfDamageByYear) <- DCol
head(dfDamageByYear)
dfDamageByYear$TotalDamage <- dfDamageByYear$PropertyDamage + dfDamageByYear$CropDamage
head(dfDamageByYear)
nrow(dfDamageByYear)
nrow(dfHarmByYear)
plot(dfHarmByYear$Year, dfHarmByYear$TotalHarm)
plot(dfHarmByYear$Year, dfHarmByYear$EventType)
plot(dfHarmByYear$Year, dfHarmByYear$Fatalities)
setwd("~/Documents/DDCI/Education/JohnsHopkins/ReproducibleResearch/Assignment1/RepData_PeerAssessment1")
